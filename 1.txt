echo \"#!/bin/bash\n\n# portRange=\"80-81\" \t# 可用于读取配置文件\n# rangeStart=$(echo ${portRange} | awk -F '-' '{print $1}')\n# rangeEnd=$(echo ${portRange} | awk -F '-' '{print $2}')\n\nrangeStart=$1\nrangeEnd=$2\n\nif [ $1 -le $2 ]; then\n\techo \"123\" > /dev/null\nelse\n\techo \"error: please check port range\"\n\texit\nfi\n\nPORT=0\n# 判断当前端口是否被占用，没被占用返回0，反之1\nfunction Listening {\n   # 不严谨写法\n   # TCPListeningnum=`netstat -an | grep \":$1 \" | awk '$1 == \"tcp\" && $NF == \"LISTEN\" {print $0}' | wc -l`\n   # UDPListeningnum=`netstat -an | grep \":$1 \" | awk '$1 == \"udp\" && $NF == \"0.0.0.0:*\" {print $0}' | wc -l`\n   # 严谨写法 -- 修改时间 2022-07-22\n   TCPListeningnum=`netstat -an | grep \":$1 \" | awk '/^tcp.*/ && $NF == \"LISTEN\" {print $0}' | wc -l`\n   UDPListeningnum=`netstat -an | grep \":$1 \" | awk '/^udp.*/ && $NF == \"0.0.0.0:*\" {print $0}' | wc -l`\n   (( Listeningnum = TCPListeningnum + UDPListeningnum ))\n   if [ $Listeningnum == 0 ]; then\n       echo \"0\"\n   else\n       echo \"1\"\n   fi\n}\n\n# 指定区间随机数\nfunction random_range {\n   shuf -i $1-$2 -n1\n}\n\n# 得到随机端口\nfunction get_random_port {\n   templ=0\n   cnt=0\n   while [[ $PORT == 0 && $cnt -le 100 ]]; do\n       cnt=`expr $cnt + 1`\n       temp1=`random_range $1 $2`\n       if [ `Listening $temp1` == 0 ] ; then\n              PORT=$temp1\n       fi\n   done\n   echo \"$PORT\"\n}\n\n# main\nget_random_port ${rangeStart} ${rangeEnd};\n    \" > ~/cugoj/scripts/getPort.sh
